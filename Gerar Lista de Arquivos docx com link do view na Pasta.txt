$BASE_VIEWER = "https://view.officeapps.live.com/op/view.aspx?src="
$BASE_DOCX   = "https://engprbo.github.io/artigos_resumos/"

Get-ChildItem *.docx | Sort-Object Name | ForEach-Object {

    $docx = $_.Name
    
    # Codifica o nome do arquivo para URL (espaços, acentos, etc.)
    $docxEncoded = [uri]::EscapeDataString($docx)

    # Monta o link completo para o Office Viewer
    $viewerUrl = $BASE_VIEWER + $BASE_DOCX + $docxEncoded

    "<li><a href=""$viewerUrl"" target=""_blank"">$docx</a></li>"

} | Out-File itens_resumos.html -Encoding utf8

Write-Host "OK: itens_resumos.html gerado com links para visualização no navegador."
